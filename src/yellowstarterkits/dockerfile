ARG BASE_IMAGE
ARG ARTIFACT_PATH

FROM ${BASE_IMAGE}

ARG PUBLIC_URL
ARG SITECORE_API_KEY
ARG SITECORE_API_HOST

ENV PUBLIC_URL=$PUBLIC_URL
ENV SITECORE_API_KEY=$SITECORE_API_KEY
ENV SITECORE_API_HOST=$SITECORE_API_HOST

COPY ${ARTIFACT_PATH} app

WORKDIR /app

RUN npm install
RUN npm run build

EXPOSE 3000

CMD ["npm", "run", "start:production"]